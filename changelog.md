# Changelog

Все важные изменения в этом проекте будут документированы в этом файле.

## [1.0.1] - 2025-09-06

### Добавлено
- **Документация системы контроля доступа** - создан файл `COMMANDS_ACCESS_CONTROL.md` с подробным описанием системы ролей и прав доступа к командам
- **Обновленное описание ролей в README** - добавлена информация о централизованной системе `RoleManager` и ссылка на подробную документацию
- **Миграция на rcon-client** - обновлена система работы с Minecraft RCON с устаревшей `minecraft-server-util` на современную `rcon-client@^4.2.3`

### Изменено
- **Улучшенное описание команд** - в README.md команды теперь содержат информацию о требуемых правах доступа
- **Структурированная документация** - система ролей и команд теперь документирована в отдельном файле для лучшей навигации
- **MinecraftService** - полностью переписан для работы с `rcon-client`, улучшена стабильность RCON подключений и обработка ошибок
- **Зависимости проекта** - удалены устаревшие `minecraft-server-util` и `minecraft-protocol`, добавлена современная `rcon-client`

## [1.0.0] - 2025-09-06

### Добавлено

#### Основная функциональность бота
- **Система регистрации пользователей** - автоматическое сохранение данных при команде /start
- **Подача заявок на вступление** - пользователи могут подать заявку с указанием Minecraft никнейма и причины
- **Система голосования** - участники могут голосовать за/против новых заявок
- **Автоматическое управление белым списком** - интеграция с Minecraft сервером через RCON
- **Система уведомлений** - рассылка уведомлений о новых заявках всем участникам и администраторам

#### Пользовательские роли и права
- **Роли пользователей**: Заявитель (applicant), Участник (member), Администратор (admin)
- **Система прав голосования** - автоматическое предоставление прав голоса участникам
- **Контроль доступа** - разграничение функций по ролям пользователей

#### Система рейтинга и репутации
- **Оценка участников** - возможность ставить положительные/отрицательные оценки
- **Система репутации** - автоматический подсчет репутации на основе оценок
- **Автоматическое исключение** - удаление участников при достижении порога негативных оценок
- **Кулдаун между оценками** - ограничение частоты оценивания одного пользователя
- **Дневной лимит оценок** - ограничение количества оценок в день

#### Интерфейс и навигация
- **Базовое меню для новых пользователей**: Подать заявку, Связь с администрацией, Информация о проекте, Версия бота
- **Расширенное меню для участников**: дополнительно Игроки, Заявки
- **Список участников** - просмотр всех участников с возможностью оценки
- **Профили пользователей** - детальная информация о каждом участнике
- **Интерактивные клавиатуры** - удобная навигация через inline-кнопки

#### Административная панель
- **Управление заявками** - просмотр, одобрение, отклонение заявок
- **Настройки голосования** - изменение продолжительности голосования и минимального количества голосов
- **Настройки рейтинга** - управление порогом негативных оценок
- **Управление сервером** - проверка статуса, управление белым списком
- **Статистика системы** - просмотр общей статистики бота

#### Интеграция с Minecraft
- **Проверка никнеймов** - валидация через Mojang API
- **Генерация offline UUID** - поддержка offline серверов
- **RCON интеграция** - выполнение команд на сервере
- **Управление белым списком** - автоматическое добавление/удаление игроков
- **Мониторинг сервера** - проверка статуса и информации о сервере

#### База данных и архитектура
- **MariaDB интеграция** - надежное хранение данных
- **Система миграций** - автоматическое обновление схемы БД
- **Репозиторный паттерн** - чистая архитектура доступа к данным
- **Кэширование** - оптимизация производительности
- **Транзакционная безопасность** - обеспечение целостности данных

#### Дополнительные возможности
- **Система вопросов к заявкам** - возможность задавать вопросы заявителям
- **Логирование** - подробное логирование всех операций
- **Обработка ошибок** - централизованная система обработки ошибок
- **Конфигурация через переменные окружения** - гибкая настройка
- **Docker поддержка** - контейнеризация для легкого развертывания

### Техническая реализация
- **TypeScript** - типобезопасная разработка
- **Bun runtime** - высокопроизводительная среда выполнения
- **Grammy framework** - современная библиотека для Telegram Bot API
- **Модульная архитектура** - разделение на контроллеры, сервисы, репозитории
- **Компонентный подход** - переиспользуемые UI компоненты
- **Система утилит** - вспомогательные функции для работы с данными

### Безопасность
- **Валидация входных данных** - проверка всех пользовательских вводов
- **Защита от SQL инъекций** - параметризованные запросы
- **Контроль прав доступа** - проверка разрешений для каждой операции
- **Защита от спама** - ограничения на частоту действий

## [0.3.0] - 2025-04-10

### Добавлено
- Реализована система профилей пользователей
- Добавлены команды /profile и /viewprofile для просмотра профилей
- Расширен функционал оценки пользователей с детальной информацией о репутации
- Реализовано автоматическое исключение пользователей при низкой репутации
- Добавлена команда для администраторов /update_all_voting_rights
- Усовершенствована система уведомлений с информацией о профиле и рейтинге
- Обновлена справка с информацией о новых командах

### Улучшено
- Расширены возможности сервиса рейтинга с подробной статистикой
- Доработана обработка негативных оценок с указанием причины
- Улучшен алгоритм выставления рейтинга с возможностью отмены оценки
- Усовершенствован вывод профиля пользователя с отображением имени Telegram и никнейма Minecraft вместо устаревшего поля nickname
- Добавлено отображение статуса последней заявки в профиле пользователя
- Улучшена обработка Markdown-форматирования с экранированием специальных символов

## [0.2.0] - 2025-04-07

### Добавлено
- Реализована система генерации оффлайн-UUID для игроков
- Добавлена проверка статуса Minecraft-сервера перед выполнением команд
- Реализовано RCON-подключение к серверу и выполнение команд
- Автоматическое добавление игроков в белый список сервера при одобрении заявки
- Уведомления игроков о добавлении в белый список
- Удаление игроков из белого списка при исключении из сообщества

### Исправлено
- Устранена проблема с отсутствием UUID после принятия заявки
- Исправлены ошибки в определении успешности выполнения команд на сервере
- Решена проблема с настройками подключения к серверу в переменных окружения

## [0.1.0] - 2025-04-01

### Добавлено
- Реализован базовый функционал подачи заявок
- Создана система голосования за заявки
- Реализована система вопросов к кандидатам
- Добавлена панель администратора
- Создана база данных и основные репозитории

### Исправлено
- Исправлена проблема с Markdown-форматированием в сообщениях

## [Unreleased]

### Планируется
- Веб-интерфейс для администрирования
- Расширенная статистика и аналитика
- Система достижений для участников
